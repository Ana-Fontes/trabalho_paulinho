var app = WebApplication.Create();

// lista para guardar os alunos em memória
var alunos = new List<Aluno>();

// GET todos os alunos
app.MapGet("/alunos", () =>
{
    return alunos;
});

// GET aluno por ID
app.MapGet("/alunos/{id}", (int id) =>
{
    var aluno = alunos.FirstOrDefault(a => a.Id == id);
    return aluno is null ? Results.NotFound() : Results.Ok(aluno);
});

// POST criar aluno
app.MapPost("/alunos", (Aluno aluno) =>
{
    // gera ID automático
    aluno.Id = alunos.Count > 0 ? alunos.Max(a => a.Id) + 1 : 1;
    alunos.Add(aluno);
    return Results.Ok("Aluno cadastrado!");
});

// PUT atualizar aluno
app.MapPut("/alunos/{id}", (int id, Aluno alunoAtualizado) =>
{
    var aluno = alunos.FirstOrDefault(a => a.Id == id);
    if (aluno is null) return Results.NotFound();

    aluno.Nome = alunoAtualizado.Nome;

    return Results.Ok("Aluno atualizado!");
});

// DELETE aluno
app.MapDelete("/alunos/{id}", (int id) =>
{
    var aluno = alunos.FirstOrDefault(a => a.Id == id);
    if (aluno is null) return Results.NotFound();

    alunos.Remove(aluno);
    return Results.Ok("Aluno removido!");
});
